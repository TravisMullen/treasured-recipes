(function(){function k(){}function F(a){q[a]||(q[a]=new Z(a));return q[a]}function t(){}function Z(a){k.prototype.init.call(this,a,k.TYPE.STANDARD)}function na(a){q[a]||(q[a]=new Z(a));return q[a]}function $(a,b){t.prototype.init.call(this,a,b)}function aa(a,b){t.prototype.init.call(this,a,b)}function m(a){k.prototype.init.call(this,a,k.TYPE.INVITE);this.active=false;this.filterLogic=null;this.rules={};this.autoRejectTimeout=this.inviteTimeout=this.inviteDelay=this.ruleTree=null}function u(a){q[a]||
(q[a]=new m(a));return q[a]}function D(a,b,c,e,d,f,h,j){t.prototype.init.call(this,a,b);this.hasInviteAfterAccept=f;this.hasInviteAfterReject=h;this.rejectTime=j;null!==g.getCssAnimation(b)||"Custom"==c?this.renderer=new m.RENDERER[c].renderClass(a,b,m.START_POSITION[e],m.END_POSITION[d]):this.renderer=new m.RENDERER.Appear.renderClass(a,b,m.START_POSITION[e],m.END_POSITION[d])}function I(a){return u(a)?u(a).getTracker():null}function r(){}function O(a,b,c,e){r.prototype.init.call(this,a,b,c,e)}function P(a,
b,c,e){r.prototype.init.call(this,a,b,null,e)}function R(a,b,c,e){r.prototype.init.call(this,a,b,null,e)}function J(a,b){J.prototype.init.call(this,a,b,null,null)}function l(){}function S(a,b,c,e,d){l.prototype.init.call(this,a,b,c,e,d)}function T(a,b,c,e,d){l.prototype.init.call(this,a,b,c,e,d)}function ba(a,b,c,e,d){l.prototype.init.call(this,a,b,c,e,d)}function K(a){oa++;if(1E3<oa)throw Error("Error processing rule filter logic, preventing recursion");for(var b=0,c=0,e=0;e<a.length;e++){"("==a.charAt(e)?
c++:")"==a.charAt(e)&&c--;","==a.charAt(e)&&1==c&&(b=e)}if(0==a.indexOf("AND("))return c=K(a.substring(4,b)),a=K(a.substring(b+1,a.length-1)),new ca(c,a);if(0==a.indexOf("OR("))return c=K(a.substring(3,b)),a=K(a.substring(b+1,a.length-1)),new da(c,a);if(0==a.indexOf("NOT("))return c=K(a.substring(4,a.length-1)),new ea(c);if(!isNaN(parseInt(a,10)))return new fa(parseInt(a,10));throw Error("Encountered unexpected character in filter logic");}function B(){}function fa(a){this.ruleId=a;B.prototype.init.call(this,
null,null)}function ca(a,b){B.prototype.init.call(this,a,b)}function da(a,b){B.prototype.init.call(this,a,b)}function ea(a){B.prototype.init.call(this,a,null)}function ya(a,b,c,e){var d=document.createElement("div");d.id="liveagent_invite_button_"+a;var f=document.createElement("img");f.style.cursor="pointer";f.style.position="absolute";f.style.right="-20px";f.style.top="-20px";f.src=n.contentServerUrl+"/images/x.png";g.addEventListener(f,"click",function(){o.rejectChat(a)});d.appendChild(f);f=document.createElement("img");
f.style.cursor="pointer";f.style.clear="right";f.src=b;f.width=c;f.height=e;g.addEventListener(f,"click",function(){o.startChat(a)});d.appendChild(f);document.body.appendChild(d);return d}function pa(a,b){this.getLabel=function(){return a};this.getValue=function(){return b};var c=new ga;this.getMapper=function(){return c}}function ga(){var a=[],b=[];this.getEntityMaps=function(){return a};this.getTranscriptFields=function(){return b}}function qa(a,b,c,e,d){this.getEntityName=function(){return a};
this.getFieldName=function(){return b};this.getFastFill=function(){return c};this.getAutoQuery=function(){return e};this.getExactMatch=function(){return d}}function U(){if(!ra){ra=true;g.log("DOM is ready. Setting up environment.");null==v.getOref()&&v.setOref(document.referrer);null==v.getVisitCount()&&v.setVisitCount(1);if(window._laq)for(var a=0;a<window._laq.length;a++)window._laq[a].call(window);p.connection.setCallback("liveagent._.handlePing");sa()}}function sa(){var a=[],b={};ha&&(b.chatted=
1);w?(b.sid=w,g.log("Reusing existing session.")):(a.push(new p.Noun("VisitorId")),g.log("Requesting new session."));a.push(new p.Noun("Settings",{buttonIds:"["+ta()+"]",updateBreadcrumb:1}));p.connection.send(a,b)}function ua(a,b){b.endpointUrl&&a.setEndpoint(b.endpointUrl);b.prechatUrl&&a.setPrechat(b.prechatUrl);b.language&&a.setLanguage(b.language);a.setOnlineState(b.isAvailable)}function za(){if(p.connection.isRunning())if(null==w)sa();else{g.log("Pinging server to keep presence");V=null;var a=
{};a.sid=w;ha&&(a.chatted=1);a.r=(new Date).getMilliseconds();var b=[new p.Noun("Availability",{ids:"["+ta()+"]"})];p.connection.send(b,a)}}function ia(){g.log("Disconnecting from Live Agent");p.connection.setIsRunning(false);for(var a in q)q.hasOwnProperty(a)&&q[a].setOnlineState(false)}function ta(){var a=[],b={},c;for(c in q)q.hasOwnProperty(c)&&q[c].getType()==k.TYPE.STANDARD&&(b[c]=q[c]);for(var e in b)a.push(e);b={};for(var d in q)q.hasOwnProperty(d)&&q[d].getType()==k.TYPE.INVITE&&(b[d]=q[d]);
for(e in b)a.push(e);e="";for(d=0;d<a.length;d++){e+=a[d];d<a.length-1&&(e+=",")}return e}function Aa(a,b){function c(f,h,j){var i=document.createElement("input");i.name=h;i.value=j;f.appendChild(i)}var e=v.getVisitCount();null==e&&(e="0");var d=document.createElement("form");d.style.display="none";c(d,"deploymentId",n.deploymentId);c(d,"orgId",n.orgId);c(d,"vc",e);c(d,"sid",w);c(d,"ptid",v.getPermanentId());c(d,"det",g.jsonEncode(va));c(d,"oref",v.getOref());c(d,"pages",g.jsonEncode(G.getPages()));
c(d,"sessionStart",(new Date).getTime()-G.getSessionStart());ja&&c(d,"visitorName",ja);d.method="POST";d.action=b;d.target=a;document.body.appendChild(d);d.submit()}function wa(a){a?g.log("Server Warning: "+a):g.log("Server sent an anoymous warning.")}function xa(a){a?g.log("Server Error: "+a):g.log("Server responded with an error.");ia()}if(!window.liveAgentDeployment){window.liveAgentDeployment=true;var o={};window.liveagent&&(o=window.liveagent);window.liveagent=o;var g={getCookie:function(a){var b=
document.cookie,c=b.indexOf(a+"=");if(-1==c)return null;c+=(a+"=").length;a=b.indexOf(";",c);-1==a&&(a=b.length);return b.substring(c,a)},setCookie:function(a,b,c){a=a+"="+b+";";c&&(c=new Date,c.setFullYear(c.getFullYear()+10),a+="expires="+c.toGMTString()+";");document.cookie=a+"path=/;"},addEventListener:function(a,b,c){if(a.addEventListener)a.addEventListener(b,c,false);else if(a.attachEvent)a.attachEvent("on"+b,c,false);else throw Error("Could not add event listener");},log:function(a){W&&window.console&&
window.console.log&&window.console.log("LIVE AGENT: "+a)},logGroupStart:function(a){W&&window.console&&(window.console.group?window.console.groupCollapsed("LIVE AGENT: "+a):g.log(a))},logGroupEnd:function(){W&&window.console&&window.console.group&&window.console.groupEnd()},getLanguage:function(){return"undefined"!=typeof window.navigator.language?window.navigator.language:"undefined"!=typeof window.navigator.userLanguage?window.navigator.userLanguage:""},arrayHasItem:function(a,b){if(Array.prototype.indexOf)return-1<
a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]==b)return true},jsonEncode:function(a,b,c){function e(y){h.lastIndex=0;return h.test(y)?'"'+y.replace(h,function(Q){var x=j[Q];return"string"===typeof x?x:"\\u"+("0000"+Q.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+y+'"'}function d(y,Q){var x,H,E,X,Y=i,C,s=Q[y];s&&"object"===typeof s&&"function"===typeof s.toJSON&&(s=s.toJSON(y));"function"===typeof z&&(s=z.call(Q,y,s));switch(typeof s){case "string":return e(s);case "number":return isFinite(s)?
String(s):"null";case "boolean":case "null":return String(s);case "object":if(!s)return"null";i+=A;C=[];if("[object Array]"===Object.prototype.toString.apply(s)){X=s.length;for(x=0;x<X;x+=1)C[x]=d(x,s)||"null";E=0===C.length?"[]":i?"[\n"+i+C.join(",\n"+i)+"\n"+Y+"]":"["+C.join(",")+"]";i=Y;return E}if(z&&"object"===typeof z){X=z.length;for(x=0;x<X;x+=1)"string"===typeof z[x]&&(H=z[x],(E=d(H,s))&&C.push(e(H)+(i?": ":":")+E))}else for(H in s)Object.prototype.hasOwnProperty.call(Object(s),H)&&(E=d(H,
s))&&C.push(e(H)+(i?": ":":")+E);E=0===C.length?"{}":i?"{\n"+i+C.join(",\n"+i)+"\n"+Y+"}":"{"+C.join(",")+"}";i=Y;return E}}var f=Array.prototype.toJSON;window.Prototype&&delete Array.prototype.toJSON;if("undefined"!==typeof window.JSON){a=window.JSON.stringify(a,b,c);Array.prototype.toJSON=f;return a}Array.prototype.toJSON=f;if(void 0===a||null===a)return"null";var h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,j={"\u0008":"\\b",
"\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},i="",A="",z=b;if("number"===typeof c)for(f=0;f<c;f+=1)A+=" ";else"string"===typeof c&&(A=c);if(b&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("Error during JSON.stringify");return d("",{"":a})},jsonDecode:function(a){a=String(a);if("undefined"!==typeof window.JSON)return window.JSON.parse(a);var b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
b.lastIndex=0;b.test(a)&&(a=a.replace(b,function(c){return"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return eval("("+a+")");throw Error("Error during JSON.parse");},getCssAnimation:function(a){var b=["Webkit","Moz","O","ms","Khtml"];if(void 0!==a.style.animationName)return"";for(var c=0;c<b.length;c++)if(void 0!==
a.style[b[c]+"AnimationName"])return b[c].toLowerCase();return null}},v={getVisitCount:function(){var a=parseInt(g.getCookie("liveagent_vc"),10);return isNaN(a)?null:a},getOref:function(){return g.getCookie("liveagent_oref")},getPermanentId:function(){var a=g.getCookie("liveagent_ptid");return null!=a?a:""},setVisitCount:function(a){g.setCookie("liveagent_vc",a,true)},setOref:function(a){return g.setCookie("liveagent_oref",a,true)},setPermanentId:function(a){g.setCookie("liveagent_ptid",a,true)}},
G=new function(){function a(){return window.localStorage?window.localStorage:window.sessionStorage}function b(){var h=document.createElement("div");h.style.display="none";document.body.appendChild(h);h.id="liveagent_userdata_provider";h.addBehavior("#default#userData");h.load("liveagent");return{getItem:function(j){return h.getAttribute(j)},setItem:function(j,i){h.setAttribute(j,i);h.save("liveagent")},removeItem:function(j){h.removeAttribute(j);h.save("liveagent")}}}function c(){var h={};return{getItem:function(j){return h[j]},
setItem:function(j,i){h[j]=i},removeItem:function(j){delete h[j]}}}function e(){f.setItem(d.SESSION_ID,w);f.setItem(d.PAGE_COUNT,"0");f.setItem(d.SESSION_START,(new Date).getTime().toString())}var d={SESSION_ID:"liveAgentSid",PAGE_COUNT:"liveAgentPc",SESSION_START:"liveAgentStart",PAGE:"liveAgentPage_",PAGE_TIME:"liveAgentPageTime_"};a.isSupported=function(){try{return window.localStorage||window.sessionStorage}catch(h){return false}};b.isSupported=function(){return document.createElement("div").addBehavior};
var f;f=a.isSupported()?a():b.isSupported()?b():c();this.init=function(){if(f.getItem(d.SESSION_ID)){if(f.getItem(d.SESSION_ID)!=w){f.removeItem(d.SESSION_START);for(var h=f.getItem(d.PAGE_COUNT),j=25>h?0:h-25;j<h;j++){f.removeItem(d.PAGE+j);f.removeItem(d.PAGE_TIME+j)}e()}}else e();h=parseInt(f.getItem(d.PAGE_COUNT),10);25<=h&&(f.removeItem(d.PAGE+(h-25)),f.removeItem(d.PAGE_TIME+(h-25)));f.setItem(d.PAGE_COUNT,(h+1).toString());f.setItem(d.PAGE+h.toString(),window.location.href);f.setItem(d.PAGE_TIME+
h.toString(),(new Date).getTime())};this.getPageCount=function(){return parseInt(f.getItem(d.PAGE_COUNT),10)};this.getSessionStart=function(){return f.getItem(d.SESSION_START)};this.getPages=function(){for(var h=[],j=this.getPageCount(),i=25>j?0:j-25;i<j;i++)h.unshift({location:f.getItem(d.PAGE+i.toString()),time:((new Date).getTime()-parseInt(f.getItem(d.PAGE_TIME+i.toString()),10)).toString()});return h};this.getCurrentPage=function(){return f.getItem(d.PAGE+(this.getPageCount()-1).toString())};
this.clear=function(){f.clear()}};k.TYPE={STANDARD:"STANDARD",INVITE:"INVITE"};k.EVENT={BUTTON_AVAILABLE:"BUTTON_AVAILABLE",BUTTON_UNAVAILABLE:"BUTTON_UNAVAILABLE",BUTTON_ACCEPTED:"BUTTON_ACCEPTED",BUTTON_REJECTED:"BUTTON_REJECTED"};k.prototype.init=function(a,b){this.buttonId=a;this.type=b;this.onlineState=null;this.trackers=[];this.language=this.prechat=this.endpoint=null};k.prototype.getType=function(){return this.type};k.prototype.getOnlineState=function(){return this.onlineState};k.prototype.setOnlineState=
function(a){this.onlineState=a;for(var b=0;b<this.trackers.length;b++)this.trackers[b].setState(a)};k.prototype.addTracker=function(a){this.trackers.push(a)};k.prototype.setPrechat=function(a){this.prechat=a};k.prototype.setEndpoint=function(a){this.endpoint=a};k.prototype.getEndpoint=function(a){function b(){return(null!=this.endpoint?this.endpoint:n.contentServerUrl+n.chatPage)+"?language="+(this.language?this.language:"")+"#"+a}var c=null;c=null==this.prechat?b.call(this):this.prechat+"?endpoint="+
encodeURIComponent(b.call(this));return n.contentServerUrl+n.prechatHandler+"?endpoint="+encodeURIComponent(c)};k.prototype.setLanguage=function(a){this.language=a};k.prototype.startChat=function(a){if(this.dispatchEvent(k.EVENT.BUTTON_ACCEPTED)){var b=this.buttonId;document.cookie="liveagent_chatted=1;path=/;";ha=true;var c;c="deployment_id="+n.deploymentId;c=c+"&org_id="+n.orgId;c+="&button_id=";c+=b;c+="&session_id=";c+=w;b=F(b).getEndpoint(c);c="height="+n.chatWindowHeight;c=c+",width="+n.chatWindowWidth;
c+=",menubar=no";c+=",toolbar=no";c+=",location=no";c+=",personalbar=no";window.open("",a,c);Aa(a,b);return true}return false};k.prototype.rejectChat=function(){return this.dispatchEvent(k.EVENT.BUTTON_REJECTED)?true:false};k.prototype.dispatchEvent=function(a){return ka.hasOwnProperty(this.buttonId)?false===ka[this.buttonId].call(this,a)?false:true:true};t.prototype.init=function(a,b){this.buttonId=a;this.element=b};t.prototype.getId=function(){return this.buttonId};t.prototype.setState=function(a){g.log("Setting state for button "+
this.buttonId+" to "+(a?"online":"offline"));a=a?k.EVENT.BUTTON_AVAILABLE:k.EVENT.BUTTON_UNAVAILABLE;return F(this.buttonId).dispatchEvent(a)?true:false};Z.prototype=new k;$.prototype=new t;$.prototype.setState=function(a){t.prototype.setState.call(this,a)&&(this.element.style.display=a?"":"none")};aa.prototype=new t;aa.prototype.setState=function(a){t.prototype.setState.call(this,a)&&(this.element.style.display=a?"none":"")};var la=false,L=null,ma={},M={};m.prototype=new k;m.RENDERER={Slide:{renderClass:O},
Fade:{renderClass:P},Appear:{renderClass:R},Custom:{renderClass:J}};m.START_POSITION={TopLeft:{xPercent:0,xPosition:-1,xOffset:-1,yPercent:0,yPosition:-1,yOffset:-1},TopLeftTop:{xPercent:0,xPosition:0,xOffset:1,yPercent:0,yPosition:-1,yOffset:-1},Top:{xPercent:0.5,xPosition:-0.5,xOffset:0,yPercent:0,yPosition:-1,yOffset:-1},TopRightTop:{xPercent:1,xPosition:-1,xOffset:-1,yPercent:0,yPosition:-1,yOffset:-1},TopRight:{xPercent:1,xPosition:0,xOffset:1,yPercent:0,yPosition:-1,yOffset:-1},TopRightRight:{xPercent:1,
xPosition:0,xOffset:1,yPercent:0,yPosition:0,yOffset:1},Right:{xPercent:1,xPosition:0,xOffset:1,yPercent:0.5,yPosition:-0.5,yOffset:0},BottomRightRight:{xPercent:1,xPosition:0,xOffset:1,yPercent:1,yPosition:-1,yOffset:-1},BottomRight:{xPercent:1,xPosition:0,xOffset:1,yPercent:1,yPosition:0,yOffset:1},BottomRightBottom:{xPercent:1,xPosition:-1,xOffset:-1,yPercent:1,yPosition:0,yOffset:1},Bottom:{xPercent:0.5,xPosition:-0.5,xOffset:0,yPercent:1,yPosition:0,yOffset:1},BottomLeftBottom:{xPercent:0,xPosition:0,
xOffset:1,yPercent:1,yPosition:0,yOffset:1},BottomLeft:{xPercent:0,xPosition:-1,xOffset:-1,yPercent:1,yPosition:0,yOffset:1},BottomLeftLeft:{xPercent:0,xPosition:-1,xOffset:-1,yPercent:1,yPosition:-1,yOffset:-1},Left:{xPercent:0,xPosition:-1,xOffset:-1,yPercent:0.5,yPosition:-0.5,yOffset:0},TopLeftLeft:{xPercent:0,xPosition:-1,xOffset:-1,yPercent:0,yPosition:0,yOffset:1}};m.END_POSITION={TopLeft:{xPercent:0,xOffset:1,yPercent:0,yOffset:1},Top:{xPercent:0.5,xOffset:0,yPercent:0,yOffset:1},TopRight:{xPercent:1,
xOffset:-1,yPercent:0,yOffset:1},Left:{xPercent:0,xOffset:1,yPercent:0.5,yOffset:0},Center:{xPercent:0.5,xOffset:0,yPercent:0.5,yOffset:0},Right:{xPercent:1,xOffset:-1,yPercent:0.5,yOffset:0},BottomLeft:{xPercent:0,xOffset:1,yPercent:1,yOffset:-1},Bottom:{xPercent:0.5,xOffset:0,yPercent:1,yOffset:-1},BottomRight:{xPercent:1,xOffset:-1,yPercent:1,yOffset:-1}};m.prototype.setRules=function(a,b){if(a&&b){for(var c in a){var e=a[c],d=null;switch(e.type){case l.TYPE.NUMBER_OF_PAGE_VIEWS:d=new S(e.order,
this.buttonId,G.getPageCount(),e.operator,parseInt(e.value,10));break;case l.TYPE.URL_MATCH:d=new S(e.order,this.buttonId,G.getCurrentPage(),e.operator,e.value);break;case l.TYPE.SECONDS_ON_PAGE:d=new T(e.order,this.buttonId,(new Date).getTime(),e.operator,1E3*parseInt(e.value,10));break;case l.TYPE.SECONDS_ON_SITE:d=new T(e.order,this.buttonId,parseInt(G.getSessionStart(),10),e.operator,1E3*parseInt(e.value,10));break;case l.TYPE.CUSTOM_VARIABLE:d=new ba(e.order,this.buttonId,e.name,e.operator,e.value);
M.hasOwnProperty(e.name)||(M[e.name]=[]);M[e.name].push(this.buttonId)}null!=d&&this.addRule(d)}this.filterLogic=b;this.ruleTree=K(b)}};m.prototype.setOnlineState=function(a){!a&&null!==this.inviteTimeout&&(clearTimeout(this.inviteTimeout),this.inviteTimeout=null);!a&&null!==this.autoRejectTimeout&&(clearTimeout(this.autoRejectTimeout),this.autoRejectTimeout=null);k.prototype.setOnlineState.call(this,a)};m.prototype.isActive=function(){return this.active};m.prototype.setActive=function(a){this.active=
a};m.prototype.addTracker=function(a){this.trackers=[];k.prototype.addTracker.call(this,a)};m.prototype.getTracker=function(){if(1!=this.trackers.length)throw Error("InviteButtons should have exactly 1 tracker");return this.trackers[0]};m.prototype.startChat=function(a){return this.active&&k.prototype.startChat.call(this,a)?(this.getTracker().accept(),true):false};m.prototype.rejectChat=function(){return this.active&&k.prototype.rejectChat.call(this)?(this.getTracker().reject(),true):false};m.prototype.trigger=
function(){if(g.getCookie("liveagent_invite_rejected_"+this.buttonId))return false;var a=true;null!=this.ruleTree&&(g.logGroupStart("Invite "+this.buttonId+" Rule Evaluation"),g.log("Filter Logic: "+this.filterLogic),a=this.ruleTree.evaluate(this),g.logGroupEnd());if(!a&&null!=this.inviteDelay){var b=this;this.inviteTimeout=window.setTimeout(function(){b.setOnlineState(true)},this.inviteDelay);this.inviteDelay=null}return a};m.prototype.addRule=function(a){this.rules[a.getId()]=a};m.prototype.getRule=
function(a){return this.rules[a]};m.prototype.getInviteDelay=function(){return this.inviteDelay};m.prototype.setInviteDelay=function(a){g.log("Setting invite delay to: "+a);this.inviteDelay=a};m.prototype.setAutoRejectTimeout=function(a){this.autoRejectTimeout=a};D.prototype=new t;D.prototype.setState=function(a){a&&!la&&u(this.buttonId).trigger()&&t.prototype.setState.call(this,true)?(la=true,L=this.buttonId,this.renderer.render()):!a&&u(this.buttonId).isActive()&&t.prototype.setState.call(this,
false)&&(la=false,this.remove(true))};D.prototype.renderFinish=function(){u(this.buttonId).setActive(true);if(-1!=this.rejectTime){var a=this.buttonId;u(this.buttonId).setAutoRejectTimeout(window.setTimeout(function(){u(a).rejectChat()},1E3*this.rejectTime))}this.renderer.renderFinish()};D.prototype.accept=function(){this.hasInviteAfterAccept||g.setCookie("liveagent_invite_rejected_"+this.buttonId,true,false);this.remove(false)};D.prototype.reject=function(){this.hasInviteAfterReject||g.setCookie("liveagent_invite_rejected_"+
this.buttonId,true,false);this.remove(true)};D.prototype.remove=function(a){u(this.buttonId).setActive(false);this.renderer.remove(a)};D.prototype.removeFinish=function(){this.renderer.remove(false)};r.prototype.init=function(a,b,c,e){window.innerWidth?this.realWidth=window.innerWidth:document.documentElement&&document.documentElement.clientWidth?this.realWidth=document.documentElement.clientWidth:document.body&&(this.realWidth=document.body.clientWidth);window.innerHeight?this.realHeight=window.innerHeight:
document.documentElement&&document.documentElement.clientHeight?this.realHeight=document.documentElement.clientHeight:document.body&&(this.realHeight=document.body.clientHeight);this.offset=25;this.buttonId=a;this.animationPrefix=g.getCssAnimation(b);this.element=b;this.element.style.position=null!==this.animationPrefix?"fixed":"absolute";this.element.style.left="-1000px";this.element.style.top="-1000px";this.element.style.zIndex="10000";this.element.style.display="";this.width=this.element.offsetWidth;
this.height=this.element.offsetHeight;this.startPosition=c;this.endPosition=e};r.prototype.render=function(){this.element.style.display=""};r.prototype.renderFinish=function(){};r.prototype.remove=function(){this.element.style.left="-1000px";this.element.style.top="-1000px"};r.prototype.addRenderListeners=function(){var a=this.buttonId,b="AnimationIteration",c="AnimationEnd";""==this.animationPrefix?(b=b.toLowerCase(),c=c.toLowerCase()):(b=this.animationPrefix+b,c=this.animationPrefix+c);g.addEventListener(this.element,
b,function(){I(a).renderFinish()});g.addEventListener(this.element,c,function(){I(a).removeFinish()})};O.prototype=new r;O.prototype.render=function(){r.prototype.addRenderListeners.call(this);var a=this.width*this.startPosition.xPosition+this.offset*this.startPosition.xOffset,b=this.height*this.startPosition.yPosition+this.offset*this.startPosition.yOffset,c=-1*this.width*this.endPosition.xPercent+this.offset*this.endPosition.xOffset,e=-1*this.height*this.endPosition.yPercent+this.offset*this.endPosition.yOffset,
d="";""!==this.animationPrefix&&(d="-"+this.animationPrefix+"-");var f=document.createElement("style");f.innerHTML="@"+d+"keyframes slide"+this.buttonId+"{from { margin-left: "+a+"px; margin-top: "+b+"px; left: "+100*this.startPosition.xPercent+"%; top: "+100*this.startPosition.yPercent+"%; }to { margin-left: "+c+"px; margin-top: "+e+"px; left: "+100*this.endPosition.xPercent+"%; top: "+100*this.endPosition.yPercent+"%; }}";document.getElementsByTagName("head")[0].appendChild(f);this.element.style[d+
"animation-name"]="slide"+this.buttonId;this.element.style[d+"animation-duration"]="1s";this.element.style[d+"animation-iteration-count"]="2";this.element.style[d+"animation-direction"]="alternate";this.element.style[d+"animation-timing-function"]="ease-in-out";this.element.style.setProperty(d+"animation-name","slide"+this.buttonId,"");this.element.style.setProperty(d+"animation-duration","1s","");this.element.style.setProperty(d+"animation-iteration-count","2","");this.element.style.setProperty(d+
"animation-direction","alternate","");this.element.style.setProperty(d+"animation-timing-function","ease-in-out","");r.prototype.render.call(this)};O.prototype.renderFinish=function(){var a="";""!==this.animationPrefix&&(a="-"+this.animationPrefix+"-");this.element.style[a+"animation-play-state"]="paused";this.element.style.setProperty(a+"animation-play-state","paused","")};O.prototype.remove=function(a){var b="";""!==this.animationPrefix&&(b="-"+this.animationPrefix+"-");a?(this.element.style[b+
"animation-play-state"]="running",this.element.style.setProperty(b+"animation-play-state","running","")):(this.element.style[b+"animation-name"]="",this.element.style.setProperty(b+"animation-name","",""),r.prototype.remove.call(this,a))};P.prototype=new r;P.prototype.render=function(){r.prototype.addRenderListeners.call(this);var a="";""!==this.animationPrefix&&(a="-"+this.animationPrefix+"-");var b=document.createElement("style");b.innerHTML="@"+a+"keyframes fade"+this.buttonId+"{from { opacity: 0; }to { opacity: 1; }}";
document.getElementsByTagName("head")[0].appendChild(b);this.element.style[a+"animation-name"]="fade"+this.buttonId;this.element.style[a+"animation-duration"]="1s";this.element.style[a+"animation-iteration-count"]="2";this.element.style[a+"animation-direction"]="alternate";this.element.style[a+"animation-timing-function"]="ease-in-out";this.element.style.setProperty(a+"animation-name","fade"+this.buttonId,"");this.element.style.setProperty(a+"animation-duration","1s","");this.element.style.setProperty(a+
"animation-iteration-count","2","");this.element.style.setProperty(a+"animation-direction","alternate","");this.element.style.setProperty(a+"animation-timing-function","ease-in-out","");this.element.style.marginLeft=-1*this.width*this.endPosition.xPercent+this.offset*this.endPosition.xOffset+"px";this.element.style.left=100*this.endPosition.xPercent+"%";this.element.style.marginTop=-1*this.height*this.endPosition.yPercent+this.offset*this.endPosition.yOffset+"px";this.element.style.top=100*this.endPosition.yPercent+
"%";r.prototype.render.call(this)};P.prototype.renderFinish=function(){var a="";""!==this.animationPrefix&&(a="-"+this.animationPrefix+"-");this.element.style[a+"animation-play-state"]="paused";this.element.style.setProperty(a+"animation-play-state","paused","")};P.prototype.remove=function(a){var b="";""!==this.animationPrefix&&(b="-"+this.animationPrefix+"-");a?(this.element.style[b+"animation-play-state"]="running",this.element.style.setProperty(b+"animation-play-state","running",""),this.element.style.opacity=
0):(this.element.style[b+"animation-name"]="",this.element.style.setProperty(b+"animation-name","",""),r.prototype.remove.call(this,a))};R.prototype=new r;R.prototype.render=function(){this.element.style.marginLeft=-1*this.width*this.endPosition.xPercent+this.offset*this.endPosition.xOffset+"px";this.element.style.left=100*this.endPosition.xPercent+"%";this.element.style.marginTop=-1*this.height*this.endPosition.yPercent+this.offset*this.endPosition.yOffset+"px";this.element.style.top=100*this.endPosition.yPercent+
"%";r.prototype.render.call(this);I(this.buttonId).renderFinish()};R.prototype.remove=function(a){a?I(this.buttonId).removeFinish():r.prototype.remove.call(this,a)};J.prototype=new r;J.prototype.render=function(){I(this.buttonId).renderFinish()};J.prototype.renderFinish=function(){};J.prototype.remove=function(a){a&&I(this.buttonId).removeFinish()};l.TYPE={NUMBER_OF_PAGE_VIEWS:"NUMBER_OF_PAGE_VIEWS",URL_MATCH:"URL_MATCH",SECONDS_ON_PAGE:"SECONDS_ON_PAGE",SECONDS_ON_SITE:"SECONDS_ON_SITE",CUSTOM_VARIABLE:"CUSTOM_VARIABLE"};
l.OPERATOR={EQUALS:"EQUALS",NOT_EQUAL:"NOT_EQUAL",START_WITH:"START_WITH",CONTAINS:"CONTAINS",NOT_CONTAIN:"NOT_CONTAIN",LESS_THAN:"LESS_THAN",GREATER_THAN:"GREATER_THAN",LESS_OR_EQUAL:"LESS_OR_EQUAL",GREATER_OR_EQUAL:"GREATER_OR_EQUAL"};l.prototype.init=function(a,b,c,e,d){this.ruleId=a;this.buttonId=b;this.compareFrom=c;this.operator=e;this.compareTo=d};l.prototype.getId=function(){return this.ruleId};l.prototype.evaluate=function(a,b){switch(this.operator){case l.OPERATOR.EQUALS:return g.log("Evaluate: "+
a+" == "+b),a==b;case l.OPERATOR.NOT_EQUAL:return g.log("Evaluate: "+a+" != "+b),a!=b;case l.OPERATOR.START_WITH:return g.log("Evaluate: "+a+" indexOf "+b+" == 0"),0==a.indexOf(b);case l.OPERATOR.CONTAINS:return g.log("Evaluate: "+a+" indexOf "+b+" != -1"),-1!=a.indexOf(b);case l.OPERATOR.NOT_CONTAIN:return g.log("Evaluate: "+a+" indexOf "+b+" == -1"),-1==a.indexOf(b);case l.OPERATOR.LESS_THAN:return g.log("Evaluate: "+parseFloat(a)+" < "+parseFloat(b)),parseFloat(a)<parseFloat(b);case l.OPERATOR.GREATER_THAN:return g.log("Evaluate: "+
parseFloat(a)+" > "+parseFloat(b)),parseFloat(a)>parseFloat(b);case l.OPERATOR.LESS_OR_EQUAL:return g.log("Evaluate: "+parseFloat(a)+" <= "+parseFloat(b)),parseFloat(a)<=parseFloat(b);case l.OPERATOR.GREATER_OR_EQUAL:return g.log("Evaluate: "+parseFloat(a)+" >= "+parseFloat(b)),parseFloat(a)>=parseFloat(b)}};S.prototype=new l;S.prototype.evaluate=function(){g.log("Evaluating StandardInviteRule");return l.prototype.evaluate.call(this,this.compareFrom,this.compareTo)};T.prototype=new l;T.prototype.evaluate=
function(){g.log("Evaluating TimerInviteRule");var a=(new Date).getTime()-this.compareFrom,b=l.prototype.evaluate.call(this,a,this.compareTo);!b&&a<=this.compareTo&&(a=this.compareTo-a,(null==u(this.buttonId).getInviteDelay()||a<u(this.buttonId).getInviteDelay())&&u(this.buttonId).setInviteDelay(a));return b};ba.prototype=new l;ba.prototype.evaluate=function(){if(ma.hasOwnProperty(this.compareFrom))return g.log("Evaluating CustomInviteRule"),l.prototype.evaluate.call(this,ma[this.compareFrom].toString(),
this.compareTo);g.log("CustomInviteRule evaluation failed due to missing custom variable");return false};var oa=0;B.prototype.init=function(a,b){this.left=a;this.right=b};B.prototype.evaluate=function(){return false};fa.prototype=new B;fa.prototype.evaluate=function(a){g.log("Evaluating Atom Node: "+this.ruleId);return a.getRule(this.ruleId).evaluate()};ca.prototype=new B;ca.prototype.evaluate=function(a){g.logGroupStart("Evaluating And Node");a=this.left.evaluate(a)&&this.right.evaluate(a);g.logGroupEnd();
return a};da.prototype=new B;da.prototype.evaluate=function(a){g.logGroupStart("Evaluating Or Node");a=this.left.evaluate(a)||this.right.evaluate(a);g.logGroupEnd();return a};ea.prototype=new B;ea.prototype.evaluate=function(a){g.logGroupStart("Evaluating Not Node");a=!this.left.evaluate(a);g.logGroupEnd();return a};pa.prototype.toJSON=function(){return{label:this.getLabel(),value:this.getValue(),entityMaps:this.getMapper().getEntityMaps(),transcriptFields:this.getMapper().getTranscriptFields()}};
ga.prototype.map=function(a,b,c,e,d){"undefined"==typeof c&&(c=true);"undefined"==typeof e&&(e=true);"undefined"==typeof d&&(d=true);this.getEntityMaps().push(new qa(a,b,c,e,d))};ga.prototype.saveToTranscript=function(a){this.getTranscriptFields().push(a)};qa.prototype.toJSON=function(){return{entityName:this.getEntityName(),fieldName:this.getFieldName(),fastFill:this.getFastFill(),autoQuery:this.getAutoQuery(),exactMatch:this.getExactMatch()}};var N={};o._=N;N.handlePing=function(a){p.connection.handlePing(a)};
N.error=function(a){a?g.log("Server Error: "+a):g.log("Server responded with an error.");ia()};N.warning=function(a){a?g.log("Server Warning: "+a):g.log("Server sent an anoymous warning.")};N.setNewPtid=function(a){v.setPermanentId(a)};N.clearStorage=function(){G.clear()};o.init=function(a,b,c){if("string"!=typeof a||"string"!=typeof b||"string"!=typeof c)throw Error("The parameters to init must be strings");n.url=a;n.deploymentId=b;n.orgId=c;g.log("System Initialized. Waiting for the DOM to be ready");
"complete"===document.readyState?setTimeout(U,1):document.addEventListener?(document.addEventListener("DOMContentLoaded",U,false),window.addEventListener("load",U,false)):window.attachEvent?window.attachEvent("onload",U):g.log("No available event model. Exiting.")};o.getSid=function(){return w};o.enableLogging=function(){W=true};o.setLocation=function(){};o.setChatWindowWidth=function(a){n.chatWindowWidth=a};o.setChatWindowHeight=function(a){n.chatWindowHeight=a};o.disconnect=function(){ia()};o.startChat=
function(a){F(a).startChat("liveagent"+Math.round(1E5*Math.random())+(new Date).getTime())};o.startChatWithWindow=function(a,b){F(a).startChat(b)};o.rejectChat=function(a){F(a).rejectChat()};o.showWhenOnline=function(a,b){if(p.connection.isRunning())throw Error("You cannot add a button after page initialization.");na(a).addTracker(new $(a,b))};o.showWhenOffline=function(a,b){if(p.connection.isRunning())throw Error("You cannot add a button after page initialization.");na(a).addTracker(new aa(a,b))};
o.addCustomDetail=function(a,b){if(p.connection.isRunning())throw Error("You cannot add a detail after page initialization.");var c=new pa(a,b);va.push(c);var e={map:function(d,f,h,j,i){c.getMapper().map(d,f,h,j,i);return e},saveToTranscript:function(d){c.getMapper().saveToTranscript(d);return e}};return e};o.setName=function(a){if(p.connection.isRunning())throw Error("You cannot set the name after page initialization.");ja=a};o.addButtonEventHandler=function(a,b){"function"==typeof b&&(ka[a]=b)};
o.BUTTON_EVENT=k.EVENT;o.setCustomVariable=function(a,b){ma[a]=b;if(M.hasOwnProperty(a))for(var c=0;c<M[a].length;c++){var e=u(M[a][c]);e.getOnlineState()&&e.setOnlineState(true)}};var p={VisitorMessage:{ERROR:"Error",WARNING:"Warning"},SystemMessage:{SWITCH_SERVER:"SwitchServer"}};(function(){var a=null,b=false,c=null,e=null,d={};(function(){d.send=function(f,h){if(null!==c)d.onError.call(window,"Did not handle response before sending another message");else{"undefined"==typeof h&&(h={});var j="Visitor",
i="",A=false;1<f.length?(j="System",i="MultiNoun",h.nouns="",A=true):i=f[0].getName();j=n.url+"/rest/"+j+"/"+i+".jsonp?";for(i=0;i<f.length;i++){A&&(h.nouns+=f[i].getName()+",");h[f[i].getName()+".prefix"]="Visitor";for(var z in f[i].getData())f[i].getData().hasOwnProperty(z)&&(h[f[i].getName()+"."+z]=f[i].getData()[z])}A&&(h.nouns=h.nouns.substr(0,h.nouns.length-1));for(var y in h)h.hasOwnProperty(y)&&(j+=y+"="+h[y]+"&");j+="callback="+a;j+="&deployment_id="+n.deploymentId;j+="&org_id="+n.orgId;
j+="&version=28";A=document.createElement("script");A.type="text/javascript";A.src=j;c=document.body.appendChild(A);e=window.setTimeout(function(){d.onError.call(window,"Server failed to respond.")},n.pingTimeout)}};d.handlePing=function(f){e&&(clearTimeout(e),e=null);b=true;f="undefined"!=typeof f.messages?f.messages:[f];for(var h=0;h<f.length;h++)d.messageHandler.call(window,f[h].type,f[h].message);d.onSuccess.call(window);null!==c&&(document.body.removeChild(c),c=null)};d.messageHandler=function(){};
d.onSuccess=function(){};d.onError=function(){};d.isRunning=function(){return b};d.setIsRunning=function(f){b=f};d.setCallback=function(f){a=f}})();p.connection=d;p.Noun=function(f,h){this.getName=function(){return f};this.getData=function(){return h}}})();var w=g.getCookie("liveagent_sid"),ha=g.getCookie("liveagent_chatted"),ra=false,W=false,q={},va=[],ja=null,ka={},V=null,n={url:null,deploymentId:null,orgId:null,pingRate:null,pingTimeout:5E3,chatWindowWidth:482,chatWindowHeight:350,contentServerUrl:null,
chatPage:"/s/chat",prechatHandler:"/s/prechatVisitor"};p.connection.messageHandler=function(a,b){switch(a){case "VisitorId":b.sessionId&&(g.log("Received new session ID"),w=b.sessionId,document.cookie="liveagent_sid="+encodeURIComponent(w)+";path=/;",null!=v.getVisitCount()&&v.setVisitCount(v.getVisitCount()+1),v.getPermanentId()||v.setPermanentId(w));break;case "Settings":G.init();g.log("Ping rate set to "+b.pingRate+"ms");n.pingRate=b.pingRate;n.contentServerUrl=b.contentServerUrl;for(var c=0;c<
b.buttons.length;c++)switch(b.buttons[c].type){case "Standard":var e=b.buttons[c],d=F(e.id);d&&ua(d,e);break;case "Invite":e=b.buttons[c];var f=null;f=e.inviteImageUrl?ya(e.id,e.inviteImageUrl,e.inviteImageWidth,e.inviteImageHeight):document.getElementById("liveagent_invite_button_"+e.id);null==f?wa("Warning: Button "+e.id+" disabled because HTML element was not found"):(d=u(e.id),d.addTracker(new D(e.id,f,e.inviteRenderer,e.inviteStartPosition,e.inviteEndPosition,e.hasInviteAfterAccept,e.hasInviteAfterReject,
e.inviteRejectTime)),f=g.jsonDecode(e.inviteRules),d.setRules(f.rules,f.filter),ua(d,e))}break;case "Availability":c={};for(e=0;e<b.results.length;e++)(d=F(b.results[e].id))&&(c[b.results[e].id]={button:d,isAvailable:b.results[e].isAvailable});null!=L&&c.hasOwnProperty(L)&&(c[L].button.setOnlineState(c[L].isAvailable),delete c[L]);for(f in c)c.hasOwnProperty(f)&&c[f].button.setOnlineState(c[f].isAvailable);break;case p.VisitorMessage.WARNING:wa(b.text);break;case p.VisitorMessage.ERROR:xa(b.text);
break;case p.SystemMessage.SWITCH_SERVER:c=b.newUrl;if("string"===typeof c){n.url=c;g.log("Received updated LiveAgent server url: "+c+"! Consider updating this site's deployment code.")}else throw Error("Trying to set invalid LiveAgent server url: "+c);w=null}};p.connection.onSuccess=function(){null!==V&&clearTimeout(V);V=window.setTimeout(za,n.pingRate)};p.connection.onError=function(a){xa(a)}}})();

